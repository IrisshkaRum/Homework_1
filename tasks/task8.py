import re  # Импортируем модуль для работы с регулярными выражениями
from collections import Counter  # Импортируем Counter для подсчета слов


text = """
[Куплет 1]  
В истерике кружилась мама Валя  
На заднем фоне замер папа Толя  
В радиусе метра воцарился жесточайший хаос  
Когда всем понятно стало: сын остался без диплома  
Мама, не кричи, хватит плакать, не смей      
Я не спорю — надо, но послушай отец:  
Есть у меня своя волна, и на своей волне  
Меня где-то поджидает успех  

[Предприпев 1]      
Боже, как хотел я увидеть свет  
И, как посчитал бы нужным жить, мечтал  
И вот однажды, как обычно, я летал во сне  
Вдруг увидел солнце — и тогда себе я сказал:  

[Припев]  
Я выбираю — жить в кайф!    
Я выбираю — жить в кайф!
Я выбираю — жить в кайф!       
Я выбираю — жить в кайф!

[Куплет 2]  
Это был сон, в котором я
Не прогорал, не огорчал родных и не нуждался ни в чём
В котором мне не пришлось скрывать глаза       
И лгать давним знакомым: мол, в жизни моей всё хорошо  
В моём рюкзаке пару маек, носки     
И пускай начало оставляет желать лучшего        
Все, кто меня помнит — знает, я не был таким  
А значит, и у вас получится     

[Предприпев 2]  
Ведь всё, что я хотел, это видеть свет  
И, как посчитал бы нужным жить, мечтал  
И вот однажды, как обычно, я летал во сне         
Вдруг услышав музыку — я сам себе сказал:  

[Припев]  
Я выбираю — жить в кайф!    
Я выбираю — жить в кайф!  
Я выбираю — жить в кайф!      
Я выбираю — жить в кайф!      

[Предприпев 1]  
Боже, как хотел я увидеть свет  
И, как посчитал бы нужным жить, мечтал  
И вот однажды, как обычно, я летал во сне             
Вдруг увидел солнце — и тогда себе я сказал:  

[Припев]  
Я выбираю — жить в кайф!  
Я выбираю — жить в кайф!  
Я выбираю — жить в кайф!         
Я выбираю — жить в кайф!
"""

# Функция для разбора текста песни на части
def parse_song(text):
    # Используем регулярные выражения для поиска частей песни и их текста
    parts = re.findall(r"\[(.*?)\]\s*(.*?)\n(?=\[|\Z)", text, re.S)
    # Создаем словарь, где ключ - название части, значение - текст
    song_parts = {part_name.lower(): lyrics.strip() for part_name, lyrics in parts}
    return song_parts

# Разбираем текст песни и сохраняем части в переменной song_parts
song_parts = parse_song(text)

# Функция для вывода текста определенной части песни
def print_section():
    # Спрашиваем у пользователя название части
    section_name = input("Введите название части песни (например, куплет 1, припев): ").lower()
    if section_name in song_parts:
        # Если часть найдена, выводим ее текст
        print(song_parts[section_name])
    else:
        # Если название части неправильное, сообщаем об этом
        print("Неверное название части.")

# Функция для центрирования текста
def print_centered_text():
    # Удаляем заголовки частей песни из текста
    cleaned_text = re.sub(r"\[.*?\]", "", text).strip()
    # Проходим по каждой строке и выводим ее по центру
    for line in cleaned_text.splitlines():
        if line.strip():  # Проверяем, что строка не пустая
            print(line.center(80))  # Центрируем строку

# Функция для подсчета слов в куплетах или в песне
def count_words():
    # Спрашиваем у пользователя, что он хочет подсчитать
    part = input("Введите 'куплет' или 'песня' для подсчета: ").lower()
    
    if part == "куплет":
        # Объединяем текст всех куплетов в одну строку для подсчета
        kuplets_text = " ".join([lyrics for name, lyrics in song_parts.items() if 'куплет' in name])
        text_for_count = kuplets_text
    elif part == "песня":
        # Удаляем заголовки и считаем слова во всей песне
        text_for_count = re.sub(r"\[.*?\]", "", text)
    else:
        print("Неверный ввод.")  # Сообщаем об ошибке, если ввод неправильный
        return
    
    # Находим все слова в тексте
    words = re.findall(r'\b\w[\w-]*\b', text_for_count.lower())
    # Подсчитываем количество каждого слова
    word_counts = Counter(words)
    
    # Находим три самых распространенных слова
    most_common_words = word_counts.most_common(3)
    for i, (word, count) in enumerate(most_common_words, 1):
        # Выводим результат
        print(f"{i}. \"{word}\" - {count} раз")

# Основной цикл программы
while True:
    # Спрашиваем пользователя, какую команду он хочет выполнить
    command = input("Введите команду (1 - части песни, 2 - выравнивание, 3 - подсчет слов, выход - завершить): ").lower()
    if command == "1":
        print_section()  # Вывод части песни
    elif command == "2":
        print_centered_text()  # Центрирование текста
    elif command == "3":
        count_words()  # Подсчет слов
    elif command == "выход":
        break  # Выход из программы
    else:
        print("Неверная команда.")  # Сообщаем об ошибке, если команда неверная
